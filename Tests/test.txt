n = MachineLearning.network.Network.load_from_file("nesterov.netsv")


img = Image.open("test0.png")
arr = np.array(img.getdata(), np.uint8).reshape((3, 28, 28))[0].reshape(784, 1) / 255
print(0, np.argmax(n.feed_forward(arr)))

img = Image.open("test1.png")
print(1, np.argmax(n.feed_forward(np.array(img.getdata(), np.uint8).reshape((3, 28, 28))[0].reshape(784, 1) / 255)))

img = Image.open("test2.png")
print(2, np.argmax(n.feed_forward(np.array(img.getdata(), np.uint8).reshape((3, 28, 28))[0].reshape(784, 1) / 255)))

img = Image.open("test3.png")
print(3, np.argmax(n.feed_forward(np.array(img.getdata(), np.uint8).reshape((3, 28, 28))[0].reshape(784, 1) / 255)))

img = Image.open("test4.png")
print(4, np.argmax(n.feed_forward(np.array(img.getdata(), np.uint8).reshape((3, 28, 28))[0].reshape(784, 1) / 255)))

img = Image.open("test5.png")
print(5, np.argmax(n.feed_forward(np.array(img.getdata(), np.uint8).reshape((3, 28, 28))[0].reshape(784, 1) / 255)))

img = Image.open("test6.png")
print(6, np.argmax(n.feed_forward(np.array(img.getdata(), np.uint8).reshape((3, 28, 28))[0].reshape(784, 1) / 255)))

img = Image.open("test7.png")
print(7, np.argmax(n.feed_forward(np.array(img.getdata(), np.uint8).reshape((3, 28, 28))[0].reshape(784, 1) / 255)))

img = Image.open("test8.png")
print(8, np.argmax(n.feed_forward(np.array(img.getdata(), np.uint8).reshape((3, 28, 28))[0].reshape(784, 1) / 255)))

img = Image.open("test9.png")
print(9, np.argmax(n.feed_forward(np.array(img.getdata(), np.uint8).reshape((3, 28, 28))[0].reshape(784, 1) / 255)))

ti, tl = MNIST.mnist_loader.load_test_data()
img = Image.fromarray(np.array(ti.T[:][0].reshape((28, 28)) * 255, np.uint8))
#img.save("train.png")
#img.show()
print(7, np.argmax(n.feed_forward(np.array(img.getdata(), np.uint8).reshape((1, 28, 28))[0].reshape(784, 1) / 255)))
print(7, np.argmax(n.feed_forward(ti[:, 0].reshape((784, 1)))))


arr1 = np.array(img.getdata(), np.uint8).reshape((1, 28, 28))[0].reshape(784, 1) / 255
arr2 = ti[:, 0].reshape((784, 1))
print(np.max(np.abs(arr1 - arr2)))

